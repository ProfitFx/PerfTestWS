//java -jar sbt-launch.jar "gatling:testOnly ESTest"
//sbt "Gatling/testOnly ESTest"
// required for Gatling core structure DSL

import io.gatling.core.Predef._

import java.text.SimpleDateFormat
import java.util.Date
import scala.util.Random
// required for Gatling HTTP DSL
import io.gatling.http.Predef._
// can be omitted if you don't use jdbcFeeder
//import io.gatling.jdbc.Predef._
// used for specifying durations with a unit, eg "5 minutes"
import scala.concurrent.duration._

import scalaj.http.Http

class ESTest extends Simulation {
  //val esurl = "http://192.168.88.245:9200"
  val esurl = "http://127.0.0.1:9200"
  val users = 100
  val bulkSize = 100
  val loopCount = 100


  def body(lineCount: Int): String = {
    val time: String = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZ").format(new Date())
    //val ind = s"""{"create":{"_index":"filebeat-7.16.2"}}"""

    val ind = s"""{"create":{"_index":"testind"}}"""

    def value = s"""{"@timestamp":"$time","log":{"offset":${Random.nextLong()}}, "value": "${Random.alphanumeric.take(12).mkString}"} """

    val bd = (for (line <- 1 to lineCount) yield ind + "\n" + value + "\n").mkString("")
    //  println(bd)
    bd
  }
  //  before(
  //    {
  //      val resp = Http(s"$esurl/my-test-index-000001").put("").asString
  //      println(resp)
  //    }
  //  )


  val httpProtocol = http // 4
    .baseUrl(esurl) // 5
    .contentTypeHeader("application/json; charset=UTF-8")
  //    .acceptHeader("text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8") // 6
  //    .doNotTrackHeader("1")
  //    .acceptLanguageHeader("en-US,en;q=0.5")
  //    .acceptEncodingHeader("gzip, deflate")
  //    .userAgentHeader("Mozilla/5.0 (Windows NT 5.1; rv:31.0) Gecko/20100101 Firefox/31.0")


  val scn = scenario("ESTest").repeat(loopCount) { // 7
    exec(
      http("BulkInsert")
        .post("/_bulk")
        .body(StringBody(session => body(bulkSize))) // 8
    ) //.pause(5) // 10
  } // 9


  setUp( // 11
    scn.inject(atOnceUsers(users)) // 12
  ).protocols(httpProtocol) // 13


  //  after(
  //    {
  //      val resp = Http(s"$esurl/my-test-index-000001").method("delete").asString
  //      println(resp)
  //    }
  //  )

}

//POST /_bulk HTTP/1.1
//Host: localhost:9200
//User-Agent: Elastic-filebeat/7.16.2 (linux; amd64; 3c518f4d17a15dc85bdd68a5a03d5af51d9edd8e; 2021-12-18 21:04:19 +0000 UTC)
//Content-Length: 51857
//Accept: application/json
//Content-Type: application/json; charset=UTF-8
//Accept-Encoding: gzip

//{"create":{"_index":"filebeat-7.16.2"}}
//{"@timestamp":"2021-12-26T10:01:55.984Z","log":{"offset":452052159,"file":{"path":"/var/lib/docker/containers/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea-json.log"}},"message":"{\"log\":\"{\\\"type\\\":\\\"log\\\",\\\"@timestamp\\\":\\\"2021-12-26T10:01:54+00:00\\\",\\\"tags\\\":[\\\"info\\\",\\\"elasticsearch\\\",\\\"deprecation\\\"],\\\"pid\\\":8,\\\"message\\\":\\\"Elasticsearch deprecation: 299 Elasticsearch-7.16.2-2b937c44140b6559905130a8650c64dbd0879cfb \\\\\\\"Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.16/security-minimal-setup.html to enable security.\\\\\\\"\\\\nOrigin:kibana\\\\nQuery:\\\\n200\\\\nPOST /.kibana_task_manager/_update_by_query?ignore_unavailable=true\\u0026refresh=true\\u0026conflicts=proceed\\\\n{\\\\\\\"query\\\\\\\":{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"type\\\\\\\":\\\\\\\"task\\\\\\\"}},{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"should\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"idle\\\\\\\"}},{\\\\\\\"range\\\\\\\":{\\\\\\\"task.runAt\\\\\\\":{\\\\\\\"lte\\\\\\\":\\\\\\\"now\\\\\\\"}}}]}},{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"should\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"running\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"claiming\\\\\\\"}}]}},{\\\\\\\"range\\\\\\\":{\\\\\\\"task.retryAt\\\\\\\":{\\\\\\\"lte\\\\\\\":\\\\\\\"now\\\\\\\"}}}]}}]}}],\\\\\\\"filter\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"must_not\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"should\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"running\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"claiming\\\\\\\"}}],\\\\\\\"must\\\\\\\":{\\\\\\\"range\\\\\\\":{\\\\\\\"task.retryAt\\\\\\\":{\\\\\\\"gt\\\\\\\":\\\\\\\"now\\\\\\\"}}}}}]}}]}}]}},\\\\\\\"script\\\\\\\":{\\\\\\\"source\\\\\\\":\\\\\\\"\\\\\\\\n    if (params.claimableTaskTypes.contains(ctx._source.task.taskType)) {\\\\\\\\n      if (ctx._source.task.schedule != null || ctx._source.task.attempts \\u003c params.taskMaxAttempts[ctx._source.task.taskType] || params.claimTasksById.contains(ctx._id)) {\\\\\\\\n        ctx._source.task.status = \\\\\\\\\\\\\\\"claiming\\\\\\\\\\\\\\\"; ctx._source.task.ownerId=params.fieldUpdates.ownerId; ctx._source.task.retryAt=params.fieldUpdates.retryAt;\\\\\\\\n      } else {\\\\\\\\n        ctx._source.task.status = \\\\\\\\\\\\\\\"failed\\\\\\\\\\\\\\\";\\\\\\\\n      }\\\\\\\\n    } else if (params.skippedTaskTypes.contains(ctx._source.task.taskType) \\u0026\\u0026 params.claimTasksById.contains(ctx._id)) {\\\\\\\\n      ctx._source.task.status = \\\\\\\\\\\\\\\"claiming\\\\\\\\\\\\\\\"; ctx._source.task.ownerId=params.fieldUpdates.ownerId; ctx._source.task.retryAt=params.fieldUpdates.retryAt;\\\\\\\\n    } else if (!params.skippedTaskTypes.contains(ctx._source.task.taskType)) {\\\\\\\\n      ctx._source.task.status = \\\\\\\\\\\\\\\"unrecognized\\\\\\\\\\\\\\\";\\\\\\\\n    } else {\\\\\\\\n      ctx.op = \\\\\\\\\\\\\\\"noop\\\\\\\\\\\\\\\";\\\\\\\\n    }\\\\\\\",\\\\\\\"lang\\\\\\\":\\\\\\\"painless\\\\\\\",\\\\\\\"params\\\\\\\":{\\\\\\\"fieldUpdates\\\\\\\":{\\\\\\\"ownerId\\\\\\\":\\\\\\\"kibana:2b9f9cf9-a28b-494f-8d5f-821139ad5d45\\\\\\\",\\\\\\\"retryAt\\\\\\\":\\\\\\\"2021-12-26T10:02:24.662Z\\\\\\\"},\\\\\\\"claimTasksById\\\\\\\":[],\\\\\\\"claimableTaskTypes\\\\\\\":[\\\\\\\"report:execute\\\\\\\"],\\\\\\\"skippedTaskTypes\\\\\\\":[\\\\\\\"session_cleanup\\\\\\\",\\\\\\\"reports:monitor\\\\\\\",\\\\\\\"search_sessions_monitor\\\\\\\",\\\\\\\"search_sessions_cleanup\\\\\\\",\\\\\\\"search_sessions_expire\\\\\\\",\\\\\\\"actions:.email\\\\\\\",\\\\\\\"actions:.index\\\\\\\",\\\\\\\"actions:.pagerduty\\\\\\\",\\\\\\\"actions:.swimlane\\\\\\\",\\\\\\\"actions:.server-log\\\\\\\",\\\\\\\"actions:.slack\\\\\\\",\\\\\\\"actions:.webhook\\\\\\\",\\\\\\\"actions:.servicenow\\\\\\\",\\\\\\\"actions:.servicenow-sir\\\\\\\",\\\\\\\"actions:.servicenow-itom\\\\\\\",\\\\\\\"actions:.jira\\\\\\\",\\\\\\\"actions:.resilient\\\\\\\",\\\\\\\"actions:.teams\\\\\\\",\\\\\\\"actions_telemetry\\\\\\\",\\\\\\\"cleanup_failed_action_executions\\\\\\\",\\\\\\\"alerting_telemetry\\\\\\\",\\\\\\\"alerts_invalidate_api_keys\\\\\\\",\\\\\\\"alerting_health_check\\\\\\\",\\\\\\\"lens_telemetry\\\\\\\",\\\\\\\"endpoint:user-artifact-packager\\\\\\\",\\\\\\\"security:endpoint-diagnostics\\\\\\\",\\\\\\\"security:endpoint-meta-telemetry\\\\\\\",\\\\\\\"security:telemetry-lists\\\\\\\",\\\\\\\"security:telemetry-detection-rules\\\\\\\",\\\\\\\"endpoint:metadata-check-transforms-task\\\\\\\",\\\\\\\"apm-telemetry-task\\\\\\\",\\\\\\\"alerting:transform_health\\\\\\\",\\\\\\\"alerting:.index-threshold\\\\\\\",\\\\\\\"alerting:.geo-containment\\\\\\\",\\\\\\\"alerting:.es-query\\\\\\\",\\\\\\\"alerting:xpack.ml.anomaly_detection_alert\\\\\\\",\\\\\\\"alerting:xpack.ml.anomaly_detection_jobs_health\\\\\\\",\\\\\\\"alerting:xpack.uptime.alerts.monitorStatus\\\\\\\",\\\\\\\"alerting:xpack.uptime.alerts.tlsCertificate\\\\\\\",\\\\\\\"alerting:xpack.uptime.alerts.durationAnomaly\\\\\\\",\\\\\\\"alerting:xpack.uptime.alerts.tls\\\\\\\",\\\\\\\"alerting:siem.signals\\\\\\\",\\\\\\\"alerting:siem.notifications\\\\\\\",\\\\\\\"alerting:metrics.alert.anomaly\\\\\\\",\\\\\\\"alerting:logs.alert.document.count\\\\\\\",\\\\\\\"alerting:metrics.alert.inventory.threshold\\\\\\\",\\\\\\\"alerting:metrics.alert.threshold\\\\\\\",\\\\\\\"alerting:monitoring_alert_cluster_health\\\\\\\",\\\\\\\"alerting:monitoring_alert_license_expiration\\\\\\\",\\\\\\\"alerting:monitoring_alert_cpu_usage\\\\\\\",\\\\\\\"alerting:monitoring_alert_missing_monitoring_data\\\\\\\",\\\\\\\"alerting:monitoring_alert_disk_usage\\\\\\\",\\\\\\\"alerting:monitoring_alert_thread_pool_search_rejections\\\\\\\",\\\\\\\"alerting:monitoring_alert_thread_pool_write_rejections\\\\\\\",\\\\\\\"alerting:monitoring_alert_jvm_memory_usage\\\\\\\",\\\\\\\"alerting:monitoring_alert_nodes_changed\\\\\\\",\\\\\\\"alerting:monitoring_alert_logstash_version_mismatch\\\\\\\",\\\\\\\"alerting:monitoring_alert_kibana_version_mismatch\\\\\\\",\\\\\\\"alerting:monitoring_alert_elasticsearch_version_mismatch\\\\\\\",\\\\\\\"alerting:monitoring_ccr_read_exceptions\\\\\\\",\\\\\\\"alerting:monitoring_shard_size\\\\\\\",\\\\\\\"alerting:apm.transaction_duration\\\\\\\",\\\\\\\"alerting:apm.transaction_duration_anomaly\\\\\\\",\\\\\\\"alerting:apm.error_rate\\\\\\\",\\\\\\\"alerting:apm.transaction_error_rate\\\\\\\"],\\\\\\\"taskMaxAttempts\\\\\\\":{\\\\\\\"report:execute\\\\\\\":1}}},\\\\\\\"sort\\\\\\\":[{\\\\\\\"_script\\\\\\\":{\\\\\\\"type\\\\\\\":\\\\\\\"number\\\\\\\",\\\\\\\"order\\\\\\\":\\\\\\\"asc\\\\\\\",\\\\\\\"script\\\\\\\":{\\\\\\\"lang\\\\\\\":\\\\\\\"painless\\\\\\\",\\\\\\\"source\\\\\\\":\\\\\\\"\\\\\\\\nif (doc['task.retryAt'].size()!=0) {\\\\\\\\n  return doc['task.retryAt'].value.toInstant().toEpochMilli();\\\\\\\\n}\\\\\\\\nif (doc['task.runAt'].size()!=0) {\\\\\\\\n  return doc['task.runAt'].value.toInstant().toEpochMilli();\\\\\\\\n}\\\\\\\\n    \\\\\\\"}}}],\\\\\\\"max_docs\\\\\\\":1}\\\"}\\n\",\"stream\":\"stdout\",\"time\":\"2021-12-26T10:01:54.670276483Z\"}","input":{"type":"filestream"},"ecs":{"version":"1.12.0"},"host":{"id":"2537bd52ca294c5db6aaf5ca0e98b90c","containerized":false,"ip":["192.168.88.245","fe80::a00:27ff:febd:74e6","172.18.0.1","fe80::42:e1ff:fec2:cf31","172.17.0.1","fe80::42:dfff:fecb:c4f3","fe80::5cd9:efff:fe3f:c7cb","fe80::a8f5:8eff:fe4b:1f8f","fe80::60d6:b7ff:feac:8aaf","fe80::d8fb:3dff:fea8:5d53"],"mac":["08:00:27:bd:74:e6","02:42:e1:c2:cf:31","02:42:df:cb:c4:f3","5e:d9:ef:3f:c7:cb","aa:f5:8e:4b:1f:8f","62:d6:b7:ac:8a:af","da:fb:3d:a8:5d:53"],"hostname":"fedoraserver35","name":"fedoraserver35","architecture":"x86_64","os":{"platform":"fedora","version":"35 (Server Edition)","family":"redhat","name":"Fedora Linux","kernel":"5.15.10-200.fc35.x86_64","type":"linux"}},"agent":{"hostname":"fedoraserver35","ephemeral_id":"23216420-8168-48a8-a5dc-1a15c2207f87","id":"7de29ed6-2a6a-476b-9fa6-3afc2c99407b","name":"fedoraserver35","type":"filebeat","version":"7.16.2"},"container":{"id":"c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea","labels":{"org_opencontainers_image_created":"2021-12-18T19:47:46.695Z","org_opencontainers_image_title":"Kibana","com_docker_compose_project_working_dir":"/root/elk","org_label-schema_vcs-url":"https://github.com/elastic/kibana","org_label-schema_version":"7.16.2","org_opencontainers_image_url":"https://www.elastic.co/products/kibana","com_docker_compose_version":"1.29.2","org_label-schema_usage":"https://www.elastic.co/guide/en/kibana/reference/index.html","org_label-schema_vcs-ref":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_opencontainers_image_vendor":"Elastic","com_docker_compose_project_config_files":"docker-compose.yml","com_docker_compose_service":"kibana","com_docker_compose_oneoff":"False","org_label-schema_license":"Elastic License","org_opencontainers_image_revision":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_opencontainers_image_licenses":"Elastic License","org_opencontainers_image_version":"7.16.2","com_docker_compose_config-hash":"f9e88bfedbc2de0354f66ac5f770c8c9a50f9ef236634b13e94fcbd58c1339e1","com_docker_compose_container-number":"1","org_label-schema_build-date":"2021-12-18T19:47:46.695Z","org_opencontainers_image_documentation":"https://www.elastic.co/guide/en/kibana/reference/index.html","org_label-schema_url":"https://www.elastic.co/products/kibana","com_docker_compose_project":"elk","org_label-schema_schema-version":"1.0","org_label-schema_name":"Kibana","org_opencontainers_image_source":"https://github.com/elastic/kibana","org_label-schema_vendor":"Elastic"},"image":{"name":"kibana:7.16.2"},"name":"elk_kibana_1"}}
//{"create":{"_index":"filebeat-7.16.2"}}
//{"@timestamp":"2021-12-26T10:01:55.984Z","input":{"type":"filestream"},"ecs":{"version":"1.12.0"},"host":{"mac":["08:00:27:bd:74:e6","02:42:e1:c2:cf:31","02:42:df:cb:c4:f3","5e:d9:ef:3f:c7:cb","aa:f5:8e:4b:1f:8f","62:d6:b7:ac:8a:af","da:fb:3d:a8:5d:53"],"hostname":"fedoraserver35","architecture":"x86_64","name":"fedoraserver35","os":{"family":"redhat","name":"Fedora Linux","kernel":"5.15.10-200.fc35.x86_64","type":"linux","platform":"fedora","version":"35 (Server Edition)"},"id":"2537bd52ca294c5db6aaf5ca0e98b90c","containerized":false,"ip":["192.168.88.245","fe80::a00:27ff:febd:74e6","172.18.0.1","fe80::42:e1ff:fec2:cf31","172.17.0.1","fe80::42:dfff:fecb:c4f3","fe80::5cd9:efff:fe3f:c7cb","fe80::a8f5:8eff:fe4b:1f8f","fe80::60d6:b7ff:feac:8aaf","fe80::d8fb:3dff:fea8:5d53"]},"agent":{"id":"7de29ed6-2a6a-476b-9fa6-3afc2c99407b","name":"fedoraserver35","type":"filebeat","version":"7.16.2","hostname":"fedoraserver35","ephemeral_id":"23216420-8168-48a8-a5dc-1a15c2207f87"},"container":{"id":"c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea","labels":{"org_label-schema_name":"Kibana","com_docker_compose_project_working_dir":"/root/elk","org_opencontainers_image_revision":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_opencontainers_image_created":"2021-12-18T19:47:46.695Z","org_opencontainers_image_url":"https://www.elastic.co/products/kibana","com_docker_compose_service":"kibana","com_docker_compose_project":"elk","org_label-schema_vcs-url":"https://github.com/elastic/kibana","org_opencontainers_image_licenses":"Elastic License","org_label-schema_version":"7.16.2","org_label-schema_usage":"https://www.elastic.co/guide/en/kibana/reference/index.html","org_label-schema_url":"https://www.elastic.co/products/kibana","org_opencontainers_image_vendor":"Elastic","org_opencontainers_image_documentation":"https://www.elastic.co/guide/en/kibana/reference/index.html","com_docker_compose_container-number":"1","com_docker_compose_version":"1.29.2","com_docker_compose_oneoff":"False","org_label-schema_build-date":"2021-12-18T19:47:46.695Z","com_docker_compose_config-hash":"f9e88bfedbc2de0354f66ac5f770c8c9a50f9ef236634b13e94fcbd58c1339e1","org_label-schema_license":"Elastic License","com_docker_compose_project_config_files":"docker-compose.yml","org_opencontainers_image_title":"Kibana","org_label-schema_vcs-ref":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_opencontainers_image_version":"7.16.2","org_opencontainers_image_source":"https://github.com/elastic/kibana","org_label-schema_schema-version":"1.0","org_label-schema_vendor":"Elastic"},"image":{"name":"kibana:7.16.2"},"name":"elk_kibana_1"},"message":"{\"log\":\"{\\\"type\\\":\\\"log\\\",\\\"@timestamp\\\":\\\"2021-12-26T10:01:54+00:00\\\",\\\"tags\\\":[\\\"info\\\",\\\"elasticsearch\\\",\\\"deprecation\\\"],\\\"pid\\\":8,\\\"message\\\":\\\"Elasticsearch deprecation: 299 Elasticsearch-7.16.2-2b937c44140b6559905130a8650c64dbd0879cfb \\\\\\\"Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.16/security-minimal-setup.html to enable security.\\\\\\\"\\\\nOrigin:kibana\\\\nQuery:\\\\n200\\\\nPOST /.kibana_task_manager/_update_by_query?ignore_unavailable=true\\u0026refresh=true\\u0026conflicts=proceed\\\\n{\\\\\\\"query\\\\\\\":{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"type\\\\\\\":\\\\\\\"task\\\\\\\"}},{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"should\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"idle\\\\\\\"}},{\\\\\\\"range\\\\\\\":{\\\\\\\"task.runAt\\\\\\\":{\\\\\\\"lte\\\\\\\":\\\\\\\"now\\\\\\\"}}}]}},{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"should\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"running\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"claiming\\\\\\\"}}]}},{\\\\\\\"range\\\\\\\":{\\\\\\\"task.retryAt\\\\\\\":{\\\\\\\"lte\\\\\\\":\\\\\\\"now\\\\\\\"}}}]}}]}}],\\\\\\\"filter\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"must_not\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"should\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"running\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"claiming\\\\\\\"}}],\\\\\\\"must\\\\\\\":{\\\\\\\"range\\\\\\\":{\\\\\\\"task.retryAt\\\\\\\":{\\\\\\\"gt\\\\\\\":\\\\\\\"now\\\\\\\"}}}}}]}}]}}]}},\\\\\\\"script\\\\\\\":{\\\\\\\"source\\\\\\\":\\\\\\\"\\\\\\\\n    if (params.claimableTaskTypes.contains(ctx._source.task.taskType)) {\\\\\\\\n      if (ctx._source.task.schedule != null || ctx._source.task.attempts \\u003c params.taskMaxAttempts[ctx._source.task.taskType] || params.claimTasksById.contains(ctx._id)) {\\\\\\\\n        ctx._source.task.status = \\\\\\\\\\\\\\\"claiming\\\\\\\\\\\\\\\"; ctx._source.task.ownerId=params.fieldUpdates.ownerId; ctx._source.task.retryAt=params.fieldUpdates.retryAt;\\\\\\\\n      } else {\\\\\\\\n        ctx._source.task.status = \\\\\\\\\\\\\\\"failed\\\\\\\\\\\\\\\";\\\\\\\\n      }\\\\\\\\n    } else if (params.skippedTaskTypes.contains(ctx._source.task.taskType) \\u0026\\u0026 params.claimTasksById.contains(ctx._id)) {\\\\\\\\n      ctx._source.task.status = \\\\\\\\\\\\\\\"claiming\\\\\\\\\\\\\\\"; ctx._source.task.ownerId=params.fieldUpdates.ownerId; ctx._source.task.retryAt=params.fieldUpdates.retryAt;\\\\\\\\n    } else if (!params.skippedTaskTypes.contains(ctx._source.task.taskType)) {\\\\\\\\n      ctx._source.task.status = \\\\\\\\\\\\\\\"unrecognized\\\\\\\\\\\\\\\";\\\\\\\\n    } else {\\\\\\\\n      ctx.op = \\\\\\\\\\\\\\\"noop\\\\\\\\\\\\\\\";\\\\\\\\n    }\\\\\\\",\\\\\\\"lang\\\\\\\":\\\\\\\"painless\\\\\\\",\\\\\\\"params\\\\\\\":{\\\\\\\"fieldUpdates\\\\\\\":{\\\\\\\"ownerId\\\\\\\":\\\\\\\"kibana:2b9f9cf9-a28b-494f-8d5f-821139ad5d45\\\\\\\",\\\\\\\"retryAt\\\\\\\":\\\\\\\"2021-12-26T10:02:24.662Z\\\\\\\"},\\\\\\\"claimTasksById\\\\\\\":[],\\\\\\\"claimableTaskTypes\\\\\\\":[\\\\\\\"session_cleanup\\\\\\\",\\\\\\\"reports:monitor\\\\\\\",\\\\\\\"search_sessions_monitor\\\\\\\",\\\\\\\"search_sessions_cleanup\\\\\\\",\\\\\\\"search_sessions_expire\\\\\\\",\\\\\\\"actions:.email\\\\\\\",\\\\\\\"actions:.index\\\\\\\",\\\\\\\"actions:.pagerduty\\\\\\\",\\\\\\\"actions:.swimlane\\\\\\\",\\\\\\\"actions:.server-log\\\\\\\",\\\\\\\"actions:.slack\\\\\\\",\\\\\\\"actions:.webhook\\\\\\\",\\\\\\\"actions:.servicenow\\\\\\\",\\\\\\\"actions:.servicenow-sir\\\\\\\",\\\\\\\"actions:.servicenow-itom\\\\\\\",\\\\\\\"actions:.jira\\\\\\\",\\\\\\\"actions:.resilient\\\\\\\",\\\\\\\"actions:.teams\\\\\\\",\\\\\\\"actions_telemetry\\\\\\\",\\\\\\\"cleanup_failed_action_executions\\\\\\\",\\\\\\\"alerting_telemetry\\\\\\\",\\\\\\\"alerts_invalidate_api_keys\\\\\\\",\\\\\\\"alerting_health_check\\\\\\\",\\\\\\\"lens_telemetry\\\\\\\",\\\\\\\"endpoint:user-artifact-packager\\\\\\\",\\\\\\\"security:endpoint-diagnostics\\\\\\\",\\\\\\\"security:endpoint-meta-telemetry\\\\\\\",\\\\\\\"security:telemetry-lists\\\\\\\",\\\\\\\"security:telemetry-detection-rules\\\\\\\",\\\\\\\"endpoint:metadata-check-transforms-task\\\\\\\",\\\\\\\"apm-telemetry-task\\\\\\\",\\\\\\\"alerting:transform_health\\\\\\\",\\\\\\\"alerting:.index-threshold\\\\\\\",\\\\\\\"alerting:.geo-containment\\\\\\\",\\\\\\\"alerting:.es-query\\\\\\\",\\\\\\\"alerting:xpack.ml.anomaly_detection_alert\\\\\\\",\\\\\\\"alerting:xpack.ml.anomaly_detection_jobs_health\\\\\\\",\\\\\\\"alerting:xpack.uptime.alerts.monitorStatus\\\\\\\",\\\\\\\"alerting:xpack.uptime.alerts.tlsCertificate\\\\\\\",\\\\\\\"alerting:xpack.uptime.alerts.durationAnomaly\\\\\\\",\\\\\\\"alerting:xpack.uptime.alerts.tls\\\\\\\",\\\\\\\"alerting:siem.signals\\\\\\\",\\\\\\\"alerting:siem.notifications\\\\\\\",\\\\\\\"alerting:metrics.alert.anomaly\\\\\\\",\\\\\\\"alerting:logs.alert.document.count\\\\\\\",\\\\\\\"alerting:metrics.alert.inventory.threshold\\\\\\\",\\\\\\\"alerting:metrics.alert.threshold\\\\\\\",\\\\\\\"alerting:monitoring_alert_cluster_health\\\\\\\",\\\\\\\"alerting:monitoring_alert_license_expiration\\\\\\\",\\\\\\\"alerting:monitoring_alert_cpu_usage\\\\\\\",\\\\\\\"alerting:monitoring_alert_missing_monitoring_data\\\\\\\",\\\\\\\"alerting:monitoring_alert_disk_usage\\\\\\\",\\\\\\\"alerting:monitoring_alert_thread_pool_search_rejections\\\\\\\",\\\\\\\"alerting:monitoring_alert_thread_pool_write_rejections\\\\\\\",\\\\\\\"alerting:monitoring_alert_jvm_memory_usage\\\\\\\",\\\\\\\"alerting:monitoring_alert_nodes_changed\\\\\\\",\\\\\\\"alerting:monitoring_alert_logstash_version_mismatch\\\\\\\",\\\\\\\"alerting:monitoring_alert_kibana_version_mismatch\\\\\\\",\\\\\\\"alerting:monitoring_alert_elasticsearch_version_mismatch\\\\\\\",\\\\\\\"alerting:monitoring_ccr_read_exceptions\\\\\\\",\\\\\\\"alerting:monitoring_shard_size\\\\\\\",\\\\\\\"alerting:apm.transaction_duration\\\\\\\",\\\\\\\"alerting:apm.transaction_duration_anomaly\\\\\\\",\\\\\\\"alerting:apm.error_rate\\\\\\\",\\\\\\\"alerting:apm.transaction_error_rate\\\\\\\"],\\\\\\\"skippedTaskTypes\\\\\\\":[\\\\\\\"report:execute\\\\\\\"],\\\\\\\"taskMaxAttempts\\\\\\\":{\\\\\\\"session_cleanup\\\\\\\":3,\\\\\\\"reports:monitor\\\\\\\":1,\\\\\\\"search_sessions_monitor\\\\\\\":3,\\\\\\\"search_sessions_cleanup\\\\\\\":3,\\\\\\\"search_sessions_expire\\\\\\\":3,\\\\\\\"actions:.email\\\\\\\":1,\\\\\\\"actions:.index\\\\\\\":1,\\\\\\\"actions:.pagerduty\\\\\\\":1,\\\\\\\"actions:.swimlane\\\\\\\":1,\\\\\\\"actions:.server-log\\\\\\\":1,\\\\\\\"actions:.slack\\\\\\\":1,\\\\\\\"actions:.webhook\\\\\\\":1,\\\\\\\"actions:.servicenow\\\\\\\":1,\\\\\\\"actions:.servicenow-sir\\\\\\\":1,\\\\\\\"actions:.servicenow-itom\\\\\\\":1,\\\\\\\"actions:.jira\\\\\\\":1,\\\\\\\"actions:.resilient\\\\\\\":1,\\\\\\\"actions:.teams\\\\\\\":1,\\\\\\\"actions_telemetry\\\\\\\":3,\\\\\\\"cleanup_failed_action_executions\\\\\\\":3,\\\\\\\"alerting_telemetry\\\\\\\":3,\\\\\\\"alerts_invalidate_api_keys\\\\\\\":3,\\\\\\\"alerting_health_check\\\\\\\":3,\\\\\\\"lens_telemetry\\\\\\\":3,\\\\\\\"endpoint:user-artifact-packager\\\\\\\":3,\\\\\\\"security:endpoint-diagnostics\\\\\\\":3,\\\\\\\"security:endpoint-meta-telemetry\\\\\\\":3,\\\\\\\"security:telemetry-lists\\\\\\\":3,\\\\\\\"security:telemetry-detection-rules\\\\\\\":3,\\\\\\\"endpoint:metadata-check-transforms-task\\\\\\\":3,\\\\\\\"apm-telemetry-task\\\\\\\":3,\\\\\\\"alerting:transform_health\\\\\\\":3,\\\\\\\"alerting:.index-threshold\\\\\\\":3,\\\\\\\"alerting:.geo-containment\\\\\\\":3,\\\\\\\"alerting:.es-query\\\\\\\":3,\\\\\\\"alerting:xpack.ml.anomaly_detection_alert\\\\\\\":3,\\\\\\\"alerting:xpack.ml.anomaly_detection_jobs_health\\\\\\\":3,\\\\\\\"alerting:xpack.uptime.alerts.monitorStatus\\\\\\\":3,\\\\\\\"alerting:xpack.uptime.alerts.tlsCertificate\\\\\\\":3,\\\\\\\"alerting:xpack.uptime.alerts.durationAnomaly\\\\\\\":3,\\\\\\\"alerting:xpack.uptime.alerts.tls\\\\\\\":3,\\\\\\\"alerting:siem.signals\\\\\\\":3,\\\\\\\"alerting:siem.notifications\\\\\\\":3,\\\\\\\"alerting:metrics.alert.anomaly\\\\\\\":3,\\\\\\\"alerting:logs.alert.document.count\\\\\\\":3,\\\\\\\"alerting:metrics.alert.inventory.threshold\\\\\\\":3,\\\\\\\"alerting:metrics.alert.threshold\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_cluster_health\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_license_expiration\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_cpu_usage\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_missing_monitoring_data\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_disk_usage\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_thread_pool_search_rejections\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_thread_pool_write_rejections\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_jvm_memory_usage\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_nodes_changed\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_logstash_version_mismatch\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_kibana_version_mismatch\\\\\\\":3,\\\\\\\"alerting:monitoring_alert_elasticsearch_version_mismatch\\\\\\\":3,\\\\\\\"alerting:monitoring_ccr_read_exceptions\\\\\\\":3,\\\\\\\"alerting:monitoring_shard_size\\\\\\\":3,\\\\\\\"alerting:apm.transaction_duration\\\\\\\":3,\\\\\\\"alerting:apm.transaction_duration_anomaly\\\\\\\":3,\\\\\\\"alerting:apm.error_rate\\\\\\\":3,\\\\\\\"alerting:apm.transaction_error_rate\\\\\\\":3}}},\\\\\\\"sort\\\\\\\":[{\\\\\\\"_script\\\\\\\":{\\\\\\\"type\\\\\\\":\\\\\\\"number\\\\\\\",\\\\\\\"order\\\\\\\":\\\\\\\"asc\\\\\\\",\\\\\\\"script\\\\\\\":{\\\\\\\"lang\\\\\\\":\\\\\\\"painless\\\\\\\",\\\\\\\"source\\\\\\\":\\\\\\\"\\\\\\\\nif (doc['task.retryAt'].size()!=0) {\\\\\\\\n  return doc['task.retryAt'].value.toInstant().toEpochMilli();\\\\\\\\n}\\\\\\\\nif (doc['task.runAt'].size()!=0) {\\\\\\\\n  return doc['task.runAt'].value.toInstant().toEpochMilli();\\\\\\\\n}\\\\\\\\n    \\\\\\\"}}}],\\\\\\\"max_docs\\\\\\\":10}\\\"}\\n\",\"stream\":\"stdout\",\"time\":\"2021-12-26T10:01:54.709277665Z\"}","log":{"offset":452060654,"file":{"path":"/var/lib/docker/containers/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea-json.log"}}}
//{"create":{"_index":"filebeat-7.16.2"}}
//{"@timestamp":"2021-12-26T10:01:55.984Z","host":{"os":{"family":"redhat","name":"Fedora Linux","kernel":"5.15.10-200.fc35.x86_64","type":"linux","platform":"fedora","version":"35 (Server Edition)"},"id":"2537bd52ca294c5db6aaf5ca0e98b90c","containerized":false,"ip":["192.168.88.245","fe80::a00:27ff:febd:74e6","172.18.0.1","fe80::42:e1ff:fec2:cf31","172.17.0.1","fe80::42:dfff:fecb:c4f3","fe80::5cd9:efff:fe3f:c7cb","fe80::a8f5:8eff:fe4b:1f8f","fe80::60d6:b7ff:feac:8aaf","fe80::d8fb:3dff:fea8:5d53"],"name":"fedoraserver35","mac":["08:00:27:bd:74:e6","02:42:e1:c2:cf:31","02:42:df:cb:c4:f3","5e:d9:ef:3f:c7:cb","aa:f5:8e:4b:1f:8f","62:d6:b7:ac:8a:af","da:fb:3d:a8:5d:53"],"hostname":"fedoraserver35","architecture":"x86_64"},"agent":{"ephemeral_id":"23216420-8168-48a8-a5dc-1a15c2207f87","id":"7de29ed6-2a6a-476b-9fa6-3afc2c99407b","name":"fedoraserver35","type":"filebeat","version":"7.16.2","hostname":"fedoraserver35"},"ecs":{"version":"1.12.0"},"container":{"id":"c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea","image":{"name":"kibana:7.16.2"},"name":"elk_kibana_1","labels":{"com_docker_compose_project_config_files":"docker-compose.yml","org_label-schema_vcs-url":"https://github.com/elastic/kibana","org_label-schema_build-date":"2021-12-18T19:47:46.695Z","org_opencontainers_image_source":"https://github.com/elastic/kibana","com_docker_compose_service":"kibana","org_label-schema_usage":"https://www.elastic.co/guide/en/kibana/reference/index.html","org_label-schema_url":"https://www.elastic.co/products/kibana","org_label-schema_name":"Kibana","org_opencontainers_image_title":"Kibana","org_opencontainers_image_version":"7.16.2","org_label-schema_license":"Elastic License","org_opencontainers_image_revision":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_label-schema_version":"7.16.2","com_docker_compose_oneoff":"False","com_docker_compose_version":"1.29.2","org_opencontainers_image_created":"2021-12-18T19:47:46.695Z","org_opencontainers_image_documentation":"https://www.elastic.co/guide/en/kibana/reference/index.html","org_label-schema_vcs-ref":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_opencontainers_image_vendor":"Elastic","com_docker_compose_project_working_dir":"/root/elk","org_opencontainers_image_url":"https://www.elastic.co/products/kibana","org_label-schema_vendor":"Elastic","com_docker_compose_project":"elk","org_opencontainers_image_licenses":"Elastic License","com_docker_compose_container-number":"1","com_docker_compose_config-hash":"f9e88bfedbc2de0354f66ac5f770c8c9a50f9ef236634b13e94fcbd58c1339e1","org_label-schema_schema-version":"1.0"}},"log":{"offset":452067098,"file":{"path":"/var/lib/docker/containers/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea-json.log"}},"message":"{\"log\":\"{\\\"type\\\":\\\"log\\\",\\\"@timestamp\\\":\\\"2021-12-26T10:01:54+00:00\\\",\\\"tags\\\":[\\\"info\\\",\\\"elasticsearch\\\",\\\"deprecation\\\"],\\\"pid\\\":8,\\\"message\\\":\\\"Elasticsearch deprecation: 299 Elasticsearch-7.16.2-2b937c44140b6559905130a8650c64dbd0879cfb \\\\\\\"Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.16/security-minimal-setup.html to enable security.\\\\\\\"\\\\nOrigin:kibana\\\\nQuery:\\\\n200\\\\nPOST /.kibana_task_manager/_search?ignore_unavailable=true\\\\n{\\\\\\\"query\\\\\\\":{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"type\\\\\\\":\\\\\\\"task\\\\\\\"}},{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"task.ownerId\\\\\\\":\\\\\\\"kibana:2b9f9cf9-a28b-494f-8d5f-821139ad5d45\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.status\\\\\\\":\\\\\\\"claiming\\\\\\\"}},{\\\\\\\"bool\\\\\\\":{\\\\\\\"should\\\\\\\":[{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"session_cleanup\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"reports:monitor\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"search_sessions_monitor\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"search_sessions_cleanup\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"search_sessions_expire\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.email\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.index\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.pagerduty\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.swimlane\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.server-log\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.slack\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.webhook\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.servicenow\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.servicenow-sir\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.servicenow-itom\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.jira\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.resilient\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions:.teams\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"actions_telemetry\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"cleanup_failed_action_executions\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting_telemetry\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerts_invalidate_api_keys\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting_health_check\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"lens_telemetry\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"endpoint:user-artifact-packager\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"security:endpoint-diagnostics\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"security:endpoint-meta-telemetry\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"security:telemetry-lists\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"security:telemetry-detection-rules\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"endpoint:metadata-check-transforms-task\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"apm-telemetry-task\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:transform_health\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:.index-threshold\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:.geo-containment\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:.es-query\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:xpack.ml.anomaly_detection_alert\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:xpack.ml.anomaly_detection_jobs_health\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:xpack.uptime.alerts.monitorStatus\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:xpack.uptime.alerts.tlsCertificate\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:xpack.uptime.alerts.durationAnomaly\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:xpack.uptime.alerts.tls\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:siem.signals\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:siem.notifications\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:metrics.alert.anomaly\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:logs.alert.document.count\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:metrics.alert.inventory.threshold\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:metrics.alert.threshold\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_cluster_health\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_license_expiration\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_cpu_usage\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_missing_monitoring_data\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_disk_usage\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_thread_pool_search_rejections\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_thread_pool_write_rejections\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_jvm_memory_usage\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_nodes_changed\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_logstash_version_mismatch\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_kibana_version_mismatch\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_alert_elasticsearch_version_mismatch\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_ccr_read_exceptions\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:monitoring_shard_size\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:apm.transaction_duration\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:apm.transaction_duration_anomaly\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:apm.error_rate\\\\\\\"}},{\\\\\\\"term\\\\\\\":{\\\\\\\"task.taskType\\\\\\\":\\\\\\\"alerting:apm.transaction_error_rate\\\\\\\"}}]}}]}}]}},\\\\\\\"size\\\\\\\":10,\\\\\\\"seq_no_primary_term\\\\\\\":true,\\\\\\\"sort\\\\\\\":{\\\\\\\"_script\\\\\\\":{\\\\\\\"type\\\\\\\":\\\\\\\"number\\\\\\\",\\\\\\\"order\\\\\\\":\\\\\\\"asc\\\\\\\",\\\\\\\"script\\\\\\\":{\\\\\\\"lang\\\\\\\":\\\\\\\"painless\\\\\\\",\\\\\\\"source\\\\\\\":\\\\\\\"\\\\\\\\nif (doc['task.retryAt'].size()!=0) {\\\\\\\\n  return doc['task.retryAt'].value.toInstant().toEpochMilli();\\\\\\\\n}\\\\\\\\nif (doc['task.runAt'].size()!=0) {\\\\\\\\n  return doc['task.runAt'].value.toInstant().toEpochMilli();\\\\\\\\n}\\\\\\\\n    \\\\\\\"}}}}\\\"}\\n\",\"stream\":\"stdout\",\"time\":\"2021-12-26T10:01:54.715731669Z\"}","input":{"type":"filestream"}}
//{"create":{"_index":"filebeat-7.16.2"}}
//{"@timestamp":"2021-12-26T10:01:55.984Z","agent":{"name":"fedoraserver35","type":"filebeat","version":"7.16.2","hostname":"fedoraserver35","ephemeral_id":"23216420-8168-48a8-a5dc-1a15c2207f87","id":"7de29ed6-2a6a-476b-9fa6-3afc2c99407b"},"ecs":{"version":"1.12.0"},"container":{"id":"c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea","image":{"name":"kibana:7.16.2"},"name":"elk_kibana_1","labels":{"org_label-schema_license":"Elastic License","com_docker_compose_config-hash":"f9e88bfedbc2de0354f66ac5f770c8c9a50f9ef236634b13e94fcbd58c1339e1","org_opencontainers_image_version":"7.16.2","org_opencontainers_image_licenses":"Elastic License","org_opencontainers_image_title":"Kibana","org_label-schema_vcs-url":"https://github.com/elastic/kibana","org_opencontainers_image_vendor":"Elastic","org_label-schema_schema-version":"1.0","org_opencontainers_image_created":"2021-12-18T19:47:46.695Z","org_label-schema_vendor":"Elastic","org_opencontainers_image_url":"https://www.elastic.co/products/kibana","com_docker_compose_service":"kibana","org_opencontainers_image_source":"https://github.com/elastic/kibana","com_docker_compose_version":"1.29.2","org_label-schema_usage":"https://www.elastic.co/guide/en/kibana/reference/index.html","com_docker_compose_oneoff":"False","com_docker_compose_project_config_files":"docker-compose.yml","org_opencontainers_image_documentation":"https://www.elastic.co/guide/en/kibana/reference/index.html","com_docker_compose_project_working_dir":"/root/elk","org_label-schema_url":"https://www.elastic.co/products/kibana","org_label-schema_name":"Kibana","com_docker_compose_project":"elk","org_label-schema_build-date":"2021-12-18T19:47:46.695Z","com_docker_compose_container-number":"1","org_label-schema_version":"7.16.2","org_opencontainers_image_revision":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_label-schema_vcs-ref":"9b678a13a6a3f45286f1d21856a7536a9297f42f"}},"log":{"file":{"path":"/var/lib/docker/containers/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea-json.log"},"offset":452067769},"message":"{\"log\":\"{\\\"type\\\":\\\"log\\\",\\\"@timestamp\\\":\\\"2021-12-26T10:01:54+00:00\\\",\\\"tags\\\":[\\\"info\\\",\\\"elasticsearch\\\",\\\"deprecation\\\"],\\\"pid\\\":8,\\\"message\\\":\\\"Elasticsearch deprecation: 299 Elasticsearch-7.16.2-2b937c44140b6559905130a8650c64dbd0879cfb \\\\\\\"Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.16/security-minimal-setup.html to enable security.\\\\\\\"\\\\nOrigin:kibana\\\\nQuery:\\\\n200\\\\nGET /_nodes?filter_path=nodes.*.version%2Cnodes.*.http.publish_address%2Cnodes.*.ip\\\"}\\n\",\"stream\":\"stdout\",\"time\":\"2021-12-26T10:01:54.723298948Z\"}","input":{"type":"filestream"},"host":{"architecture":"x86_64","os":{"platform":"fedora","version":"35 (Server Edition)","family":"redhat","name":"Fedora Linux","kernel":"5.15.10-200.fc35.x86_64","type":"linux"},"id":"2537bd52ca294c5db6aaf5ca0e98b90c","containerized":false,"ip":["192.168.88.245","fe80::a00:27ff:febd:74e6","172.18.0.1","fe80::42:e1ff:fec2:cf31","172.17.0.1","fe80::42:dfff:fecb:c4f3","fe80::5cd9:efff:fe3f:c7cb","fe80::a8f5:8eff:fe4b:1f8f","fe80::60d6:b7ff:feac:8aaf","fe80::d8fb:3dff:fea8:5d53"],"mac":["08:00:27:bd:74:e6","02:42:e1:c2:cf:31","02:42:df:cb:c4:f3","5e:d9:ef:3f:c7:cb","aa:f5:8e:4b:1f:8f","62:d6:b7:ac:8a:af","da:fb:3d:a8:5d:53"],"name":"fedoraserver35","hostname":"fedoraserver35"}}
//{"create":{"_index":"filebeat-7.16.2"}}
//{"@timestamp":"2021-12-26T10:01:55.984Z","host":{"id":"2537bd52ca294c5db6aaf5ca0e98b90c","containerized":false,"ip":["192.168.88.245","fe80::a00:27ff:febd:74e6","172.18.0.1","fe80::42:e1ff:fec2:cf31","172.17.0.1","fe80::42:dfff:fecb:c4f3","fe80::5cd9:efff:fe3f:c7cb","fe80::a8f5:8eff:fe4b:1f8f","fe80::60d6:b7ff:feac:8aaf","fe80::d8fb:3dff:fea8:5d53"],"mac":["08:00:27:bd:74:e6","02:42:e1:c2:cf:31","02:42:df:cb:c4:f3","5e:d9:ef:3f:c7:cb","aa:f5:8e:4b:1f:8f","62:d6:b7:ac:8a:af","da:fb:3d:a8:5d:53"],"hostname":"fedoraserver35","name":"fedoraserver35","architecture":"x86_64","os":{"version":"35 (Server Edition)","family":"redhat","name":"Fedora Linux","kernel":"5.15.10-200.fc35.x86_64","type":"linux","platform":"fedora"}},"agent":{"version":"7.16.2","hostname":"fedoraserver35","ephemeral_id":"23216420-8168-48a8-a5dc-1a15c2207f87","id":"7de29ed6-2a6a-476b-9fa6-3afc2c99407b","name":"fedoraserver35","type":"filebeat"},"container":{"id":"c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea","labels":{"com_docker_compose_project_working_dir":"/root/elk","org_label-schema_vcs-url":"https://github.com/elastic/kibana","org_label-schema_build-date":"2021-12-18T19:47:46.695Z","com_docker_compose_container-number":"1","org_opencontainers_image_revision":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_label-schema_vendor":"Elastic","org_opencontainers_image_created":"2021-12-18T19:47:46.695Z","org_label-schema_vcs-ref":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_opencontainers_image_documentation":"https://www.elastic.co/guide/en/kibana/reference/index.html","org_label-schema_url":"https://www.elastic.co/products/kibana","org_opencontainers_image_version":"7.16.2","com_docker_compose_config-hash":"f9e88bfedbc2de0354f66ac5f770c8c9a50f9ef236634b13e94fcbd58c1339e1","com_docker_compose_project_config_files":"docker-compose.yml","org_opencontainers_image_licenses":"Elastic License","org_label-schema_version":"7.16.2","org_label-schema_license":"Elastic License","org_label-schema_usage":"https://www.elastic.co/guide/en/kibana/reference/index.html","com_docker_compose_project":"elk","org_opencontainers_image_title":"Kibana","org_opencontainers_image_source":"https://github.com/elastic/kibana","org_label-schema_schema-version":"1.0","org_opencontainers_image_url":"https://www.elastic.co/products/kibana","com_docker_compose_service":"kibana","com_docker_compose_version":"1.29.2","com_docker_compose_oneoff":"False","org_opencontainers_image_vendor":"Elastic","org_label-schema_name":"Kibana"},"image":{"name":"kibana:7.16.2"},"name":"elk_kibana_1"},"log":{"file":{"path":"/var/lib/docker/containers/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea-json.log"},"offset":452069179},"message":"{\"log\":\"{\\\"type\\\":\\\"log\\\",\\\"@timestamp\\\":\\\"2021-12-26T10:01:54+00:00\\\",\\\"tags\\\":[\\\"info\\\",\\\"elasticsearch\\\",\\\"deprecation\\\"],\\\"pid\\\":8,\\\"message\\\":\\\"Elasticsearch deprecation: 299 Elasticsearch-7.16.2-2b937c44140b6559905130a8650c64dbd0879cfb \\\\\\\"Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.16/security-minimal-setup.html to enable security.\\\\\\\"\\\\nOrigin:kibana\\\\nQuery:\\\\n200\\\\nPOST /_bulk?refresh=false\\u0026_source_includes=originId\\u0026require_alias=true\\\\n{\\\\\\\"update\\\\\\\":{\\\\\\\"_id\\\\\\\":\\\\\\\"task:reports:monitor\\\\\\\",\\\\\\\"_index\\\\\\\":\\\\\\\".kibana_task_manager_7.16.2\\\\\\\"}}\\\\n{\\\\\\\"doc\\\\\\\":{\\\\\\\"task\\\\\\\":{\\\\\\\"schedule\\\\\\\":{\\\\\\\"interval\\\\\\\":\\\\\\\"3s\\\\\\\"},\\\\\\\"taskType\\\\\\\":\\\\\\\"reports:monitor\\\\\\\",\\\\\\\"retryAt\\\\\\\":\\\\\\\"2021-12-26T10:03:54.716Z\\\\\\\",\\\\\\\"runAt\\\\\\\":\\\\\\\"2021-12-26T10:01:51.694Z\\\\\\\",\\\\\\\"traceparent\\\\\\\":\\\\\\\"00-ae4bf1a561fab80cb463ff1102801723-2a6a434848fdfaae-01\\\\\\\",\\\\\\\"startedAt\\\\\\\":\\\\\\\"2021-12-26T10:01:54.716Z\\\\\\\",\\\\\\\"state\\\\\\\":\\\\\\\"{}\\\\\\\",\\\\\\\"params\\\\\\\":\\\\\\\"{}\\\\\\\",\\\\\\\"ownerId\\\\\\\":\\\\\\\"kibana:2b9f9cf9-a28b-494f-8d5f-821139ad5d45\\\\\\\",\\\\\\\"scheduledAt\\\\\\\":\\\\\\\"2021-12-25T06:24:33.258Z\\\\\\\",\\\\\\\"attempts\\\\\\\":1,\\\\\\\"status\\\\\\\":\\\\\\\"running\\\\\\\"},\\\\\\\"updated_at\\\\\\\":\\\\\\\"2021-12-26T10:01:54.768Z\\\\\\\"}}\\\\n\\\"}\\n\",\"stream\":\"stdout\",\"time\":\"2021-12-26T10:01:54.776454819Z\"}","input":{"type":"filestream"},"ecs":{"version":"1.12.0"}}
//{"create":{"_index":"filebeat-7.16.2"}}
//{"@timestamp":"2021-12-26T10:01:55.984Z","input":{"type":"filestream"},"host":{"mac":["08:00:27:bd:74:e6","02:42:e1:c2:cf:31","02:42:df:cb:c4:f3","5e:d9:ef:3f:c7:cb","aa:f5:8e:4b:1f:8f","62:d6:b7:ac:8a:af","da:fb:3d:a8:5d:53"],"name":"fedoraserver35","hostname":"fedoraserver35","architecture":"x86_64","os":{"type":"linux","platform":"fedora","version":"35 (Server Edition)","family":"redhat","name":"Fedora Linux","kernel":"5.15.10-200.fc35.x86_64"},"id":"2537bd52ca294c5db6aaf5ca0e98b90c","containerized":false,"ip":["192.168.88.245","fe80::a00:27ff:febd:74e6","172.18.0.1","fe80::42:e1ff:fec2:cf31","172.17.0.1","fe80::42:dfff:fecb:c4f3","fe80::5cd9:efff:fe3f:c7cb","fe80::a8f5:8eff:fe4b:1f8f","fe80::60d6:b7ff:feac:8aaf","fe80::d8fb:3dff:fea8:5d53"]},"agent":{"id":"7de29ed6-2a6a-476b-9fa6-3afc2c99407b","name":"fedoraserver35","type":"filebeat","version":"7.16.2","hostname":"fedoraserver35","ephemeral_id":"23216420-8168-48a8-a5dc-1a15c2207f87"},"ecs":{"version":"1.12.0"},"container":{"id":"c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea","labels":{"org_opencontainers_image_version":"7.16.2","org_opencontainers_image_licenses":"Elastic License","com_docker_compose_config-hash":"f9e88bfedbc2de0354f66ac5f770c8c9a50f9ef236634b13e94fcbd58c1339e1","org_opencontainers_image_created":"2021-12-18T19:47:46.695Z","com_docker_compose_service":"kibana","com_docker_compose_project_working_dir":"/root/elk","org_opencontainers_image_revision":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_label-schema_vcs-ref":"9b678a13a6a3f45286f1d21856a7536a9297f42f","com_docker_compose_container-number":"1","com_docker_compose_oneoff":"False","org_label-schema_vendor":"Elastic","com_docker_compose_project_config_files":"docker-compose.yml","org_opencontainers_image_vendor":"Elastic","com_docker_compose_project":"elk","org_label-schema_name":"Kibana","org_label-schema_url":"https://www.elastic.co/products/kibana","org_opencontainers_image_title":"Kibana","org_label-schema_schema-version":"1.0","com_docker_compose_version":"1.29.2","org_label-schema_usage":"https://www.elastic.co/guide/en/kibana/reference/index.html","org_label-schema_version":"7.16.2","org_label-schema_license":"Elastic License","org_opencontainers_image_source":"https://github.com/elastic/kibana","org_opencontainers_image_url":"https://www.elastic.co/products/kibana","org_label-schema_vcs-url":"https://github.com/elastic/kibana","org_opencontainers_image_documentation":"https://www.elastic.co/guide/en/kibana/reference/index.html","org_label-schema_build-date":"2021-12-18T19:47:46.695Z"},"image":{"name":"kibana:7.16.2"},"name":"elk_kibana_1"},"log":{"offset":452070322,"file":{"path":"/var/lib/docker/containers/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea-json.log"}},"message":"{\"log\":\"{\\\"type\\\":\\\"log\\\",\\\"@timestamp\\\":\\\"2021-12-26T10:01:54+00:00\\\",\\\"tags\\\":[\\\"info\\\",\\\"elasticsearch\\\",\\\"deprecation\\\"],\\\"pid\\\":8,\\\"message\\\":\\\"Elasticsearch deprecation: 299 Elasticsearch-7.16.2-2b937c44140b6559905130a8650c64dbd0879cfb \\\\\\\"Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.16/security-minimal-setup.html to enable security.\\\\\\\"\\\\nOrigin:kibana\\\\nQuery:\\\\n200\\\\nPOST /.reporting-*/_search?size=1\\u0026seq_no_primary_term=true\\u0026_source_excludes=output\\\\n{\\\\\\\"sort\\\\\\\":{\\\\\\\"created_at\\\\\\\":{\\\\\\\"order\\\\\\\":\\\\\\\"asc\\\\\\\"}},\\\\\\\"query\\\\\\\":{\\\\\\\"bool\\\\\\\":{\\\\\\\"filter\\\\\\\":{\\\\\\\"bool\\\\\\\":{\\\\\\\"should\\\\\\\":[{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"range\\\\\\\":{\\\\\\\"process_expiration\\\\\\\":{\\\\\\\"lt\\\\\\\":\\\\\\\"now\\\\\\\"}}},{\\\\\\\"terms\\\\\\\":{\\\\\\\"status\\\\\\\":[\\\\\\\"processing\\\\\\\"]}}]}},{\\\\\\\"bool\\\\\\\":{\\\\\\\"must\\\\\\\":[{\\\\\\\"terms\\\\\\\":{\\\\\\\"status\\\\\\\":[\\\\\\\"pending\\\\\\\"]}}],\\\\\\\"must_not\\\\\\\":[{\\\\\\\"exists\\\\\\\":{\\\\\\\"field\\\\\\\":\\\\\\\"migration_version\\\\\\\"}}]}}]}}}}}\\\"}\\n\",\"stream\":\"stdout\",\"time\":\"2021-12-26T10:01:54.781482125Z\"}"}
//{"create":{"_index":"filebeat-7.16.2"}}
//{"@timestamp":"2021-12-26T10:01:55.984Z","host":{"containerized":false,"ip":["192.168.88.245","fe80::a00:27ff:febd:74e6","172.18.0.1","fe80::42:e1ff:fec2:cf31","172.17.0.1","fe80::42:dfff:fecb:c4f3","fe80::5cd9:efff:fe3f:c7cb","fe80::a8f5:8eff:fe4b:1f8f","fe80::60d6:b7ff:feac:8aaf","fe80::d8fb:3dff:fea8:5d53"],"mac":["08:00:27:bd:74:e6","02:42:e1:c2:cf:31","02:42:df:cb:c4:f3","5e:d9:ef:3f:c7:cb","aa:f5:8e:4b:1f:8f","62:d6:b7:ac:8a:af","da:fb:3d:a8:5d:53"],"name":"fedoraserver35","hostname":"fedoraserver35","architecture":"x86_64","os":{"type":"linux","platform":"fedora","version":"35 (Server Edition)","family":"redhat","name":"Fedora Linux","kernel":"5.15.10-200.fc35.x86_64"},"id":"2537bd52ca294c5db6aaf5ca0e98b90c"},"agent":{"hostname":"fedoraserver35","ephemeral_id":"23216420-8168-48a8-a5dc-1a15c2207f87","id":"7de29ed6-2a6a-476b-9fa6-3afc2c99407b","name":"fedoraserver35","type":"filebeat","version":"7.16.2"},"container":{"id":"c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea","labels":{"com_docker_compose_project_config_files":"docker-compose.yml","com_docker_compose_oneoff":"False","org_label-schema_vcs-url":"https://github.com/elastic/kibana","org_opencontainers_image_vendor":"Elastic","org_opencontainers_image_documentation":"https://www.elastic.co/guide/en/kibana/reference/index.html","org_opencontainers_image_title":"Kibana","org_label-schema_version":"7.16.2","org_label-schema_name":"Kibana","com_docker_compose_config-hash":"f9e88bfedbc2de0354f66ac5f770c8c9a50f9ef236634b13e94fcbd58c1339e1","org_opencontainers_image_url":"https://www.elastic.co/products/kibana","org_opencontainers_image_source":"https://github.com/elastic/kibana","com_docker_compose_version":"1.29.2","org_label-schema_build-date":"2021-12-18T19:47:46.695Z","org_label-schema_vendor":"Elastic","org_label-schema_schema-version":"1.0","org_opencontainers_image_licenses":"Elastic License","org_opencontainers_image_version":"7.16.2","org_label-schema_vcs-ref":"9b678a13a6a3f45286f1d21856a7536a9297f42f","org_label-schema_license":"Elastic License","com_docker_compose_service":"kibana","com_docker_compose_project_working_dir":"/root/elk","org_opencontainers_image_created":"2021-12-18T19:47:46.695Z","org_label-schema_usage":"https://www.elastic.co/guide/en/kibana/reference/index.html","com_docker_compose_container-number":"1","org_label-schema_url":"https://www.elastic.co/products/kibana","com_docker_compose_project":"elk","org_opencontainers_image_revision":"9b678a13a6a3f45286f1d21856a7536a9297f42f"},"image":{"name":"kibana:7.16.2"},"name":"elk_kibana_1"},"log":{"offset":452071626,"file":{"path":"/var/lib/docker/containers/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea/c5b8948ea187a840ddef5558cdf8c5ced3786e3a9e49ecad3f5abc94cc8e13ea-json.log"}},"message":"{\"log\":\"{\\\"type\\\":\\\"log\\\",\\\"@timestamp\\\":\\\"2021-12-26T10:01:54+00:00\\\",\\\"tags\\\":[\\\"info\\\",\\\"elasticsearch\\\",\\\"deprecation\\\"],\\\"pid\\\":8,\\\"message\\\":\\\"Elasticsearch deprecation: 299 Elasticsearch-7.16.2-2b937c44140b6559905130a8650c64dbd0879cfb \\\\\\\"Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.16/security-minimal-setup.html to enable security.\\\\\\\"\\\\nOrigin:kibana\\\\nQuery:\\\\n200\\\\nPOST /_bulk?refresh=false\\u0026_source_includes=originId\\u0026require_alias=true\\\\n{\\\\\\\"update\\\\\\\":{\\\\\\\"_id\\\\\\\":\\\\\\\"task:reports:monitor\\\\\\\",\\\\\\\"_index\\\\\\\":\\\\\\\".kibana_task_manager_7.16.2\\\\\\\"}}\\\\n{\\\\\\\"doc\\\\\\\":{\\\\\\\"task\\\\\\\":{\\\\\\\"runAt\\\\\\\":\\\\\\\"2021-12-26T10:01:57.716Z\\\\\\\",\\\\\\\"state\\\\\\\":\\\\\\\"{}\\\\\\\",\\\\\\\"schedule\\\\\\\":{\\\\\\\"interval\\\\\\\":\\\\\\\"3s\\\\\\\"},\\\\\\\"attempts\\\\\\\":0,\\\\\\\"status\\\\\\\":\\\\\\\"idle\\\\\\\",\\\\\\\"startedAt\\\\\\\":null,\\\\\\\"retryAt\\\\\\\":null,\\\\\\\"ownerId\\\\\\\":null,\\\\\\\"taskType\\\\\\\":\\\\\\\"reports:monitor\\\\\\\",\\\\\\\"traceparent\\\\\\\":\\\\\\\"00-ae4bf1a561fab80cb463ff1102801723-2a6a434848fdfaae-01\\\\\\\",\\\\\\\"params\\\\\\\":\\\\\\\"{}\\\\\\\",\\\\\\\"scheduledAt\\\\\\\":\\\\\\\"2021-12-25T06:24:33.258Z\\\\\\\"},\\\\\\\"updated_at\\\\\\\":\\\\\\\"2021-12-26T10:01:54.833Z\\\\\\\"}}\\\\n\\\"}\\n\",\"stream\":\"stdout\",\"time\":\"2021-12-26T10:01:54.841212052Z\"}","input":{"type":"filestream"},"ecs":{"version":"1.12.0"}}

//curl -X POST "localhost:9200/_bulk?pretty" -H 'Content-Type: application/json' -d'
//{ "index" : { "_index" : "test", "_id" : "1" } }
//{ "field1" : "value1" }
//{ "delete" : { "_index" : "test", "_id" : "2" } }
//{ "create" : { "_index" : "test", "_id" : "3" } }
//{ "field1" : "value3" }
//{ "update" : {"_id" : "1", "_index" : "test"} }
//{ "doc" : {"field2" : "value2"} }
//'
